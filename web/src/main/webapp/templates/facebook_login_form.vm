#*
 * Copyright 2014 Stormpath, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
*#
<button class="btn btn-social btn-facebook" onclick="facebookLogin()">Facebook</button>
<script>
    function facebookLogin() {
        var FB = window.FB;

        FB.login(function(response) {
            if (response.status === 'connected') {
                var queryStr = window.location.search.replace('?', '');
                if (queryStr) {
                    window.location.replace("/facebookOauthCallback?queryStr&code=" + FB.getAuthResponse()['accessToken']);
                } else {
                    window.location.replace("/facebookOauthCallback?code=" + FB.getAuthResponse()['accessToken']);
                }
            }
        }, {scope: '$config.getFacebookScope()' });
    }

    window.fbAsyncInit = function() {
        FB.init({
            appId      : $config.getFacebookAppId(),
            cookie     : true,
            xfbml      : true,
            version    : 'v2.0'
        });
    };

    (function(d, s, id){
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) {return;}
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/en_US/sdk.js";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
</script>